{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\com\\\\Desktop\\\\YH\\\\next\\\\pages\\\\profile.js\";\nvar __jsx = React.createElement;\nimport React, { useCallback, useEffect, useState } from \"react\";\nimport AppLayout from \"../components/AppLayout\";\nimport Head from \"next/head\";\nimport NicknameEditForm from \"../components/NicknameEditForm\";\nimport Router from \"next/router\";\nimport FollowList from \"../components/FollowList\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { LOAD_FOLLOWERS_REQUEST, LOAD_FOLLOWINGS_REQUEST, LOAD_MY_INFO_REQUEST, LOAD_POSTS_REQUEST } from \"../type\";\nimport wrapper from \"../store/configureStore\";\nimport { END } from \"redux-saga\";\nimport axios from \"axios\";\nimport useSWR, { use } from \"swr\";\nconst fetcher = url => axios.get(url, {\n  withCredentials: true\n}).then(result => result.data);\nconst Profile = () => {\n  const {\n    0: followersLimit,\n    1: setFollowersLimit\n  } = useState(3);\n  const {\n    0: followingsLimit,\n    1: setFollowingsLimit\n  } = useState(3);\n  const dispatch = useDispatch();\n  const {\n    me\n  } = useSelector(state => state.user);\n  const {\n    data: followersData,\n    followerError\n  } = useSWR(`http://localhost:3075/user/followers?limit=${followersLimit}`, fetcher);\n  const {\n    data: followingsData,\n    followingError\n  } = useSWR(`http://localhost:3075/user/followings?limit=${followingsLimit}`, fetcher);\n\n  /* useEffect(() => {\n    dispatch({\n      type: LOAD_FOLLOWERS_REQUEST,\n    });\n    dispatch({\n      type: LOAD_FOLLOWINGS_REQUEST,\n    });\n  }, []);\n  */\n\n  useEffect(() => {\n    if (!(me && me.id)) {\n      Router.push(\"/\");\n    }\n  }, [me && me.id]);\n  const loadMoreFollowings = useCallback(() => {\n    setFollowingsLimit(prev => prev + 3);\n  }, []);\n  const loadMoreFollowers = useCallback(() => {\n    setFollowersLimit(prev => prev + 3);\n  }, []);\n  if (!me) {\n    return \"내 정보 로딩 중\";\n  }\n  if (followerError || followingError) {\n    console.error(followerError || followingError);\n    return __jsx(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 12\n      }\n    }, \"\\uD314\\uB85C\\uC789/\\uD314\\uB85C\\uC6CC \\uB85C\\uB529 \\uC911 \\uC5D0\\uB7EC\\uAC00 \\uBC1C\\uC0DD\\uD569\\uB2C8\\uB2E4.\");\n  }\n  return __jsx(React.Fragment, null, __jsx(Head, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 7\n    }\n  }, __jsx(\"title\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 9\n    }\n  }, \"\\uB0B4 \\uD504\\uB85C\\uD544\")), __jsx(AppLayout, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 7\n    }\n  }, __jsx(NicknameEditForm, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 9\n    }\n  }), __jsx(FollowList, {\n    header: \"\\uD314\\uB85C\\uC789\",\n    data: followingsData,\n    onClickMore: loadMoreFollowings,\n    loading: !followingsData && !followingError,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 9\n    }\n  }), __jsx(FollowList, {\n    header: \"\\uD314\\uB85C\\uC6CC\",\n    data: followersData,\n    onClickMore: loadMoreFollowers,\n    loading: !followersData && !followerError,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 9\n    }\n  })));\n};\nexport const getServerSideProps = wrapper.getServerSideProps(async context => {\n  const cookie = context.req ? context.req.headers.cookie : \"\";\n  axios.defaults.headers.Cookie = \"\";\n  if (context.req && cookie) {\n    axios.defaults.headers.Cookie = cookie;\n  } //Cookie 넣어줘야 로그인 새로고침 가능\n  context.store.dispatch({\n    type: LOAD_MY_INFO_REQUEST\n  });\n  context.store.dispatch({\n    type: LOAD_POSTS_REQUEST\n  });\n  context.store.dispatch(END);\n  await context.store.sagaTask.toPromise();\n});\nexport default Profile;","map":{"version":3,"names":["React","useCallback","useEffect","useState","AppLayout","Head","NicknameEditForm","Router","FollowList","useDispatch","useSelector","LOAD_FOLLOWERS_REQUEST","LOAD_FOLLOWINGS_REQUEST","LOAD_MY_INFO_REQUEST","LOAD_POSTS_REQUEST","wrapper","END","axios","useSWR","use","fetcher","url","get","withCredentials","then","result","data","Profile","followersLimit","setFollowersLimit","followingsLimit","setFollowingsLimit","dispatch","me","state","user","followersData","followerError","followingsData","followingError","id","push","loadMoreFollowings","prev","loadMoreFollowers","console","error","__jsx","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","Fragment","header","onClickMore","loading","getServerSideProps","context","cookie","req","headers","defaults","Cookie","store","type","sagaTask","toPromise"],"sources":["C:/Users/com/Desktop/YH/next/pages/profile.js"],"sourcesContent":["import React, { useCallback, useEffect, useState } from \"react\";\nimport AppLayout from \"../components/AppLayout\";\nimport Head from \"next/head\";\nimport NicknameEditForm from \"../components/NicknameEditForm\";\nimport Router from \"next/router\";\nimport FollowList from \"../components/FollowList\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport {\n  LOAD_FOLLOWERS_REQUEST,\n  LOAD_FOLLOWINGS_REQUEST,\n  LOAD_MY_INFO_REQUEST,\n  LOAD_POSTS_REQUEST,\n} from \"../type\";\nimport wrapper from \"../store/configureStore\";\nimport { END } from \"redux-saga\";\nimport axios from \"axios\";\nimport useSWR,{use} from \"swr\";\n\nconst fetcher = (url) =>\n  axios.get(url, { withCredentials: true }).then((result) => result.data);\n\nconst Profile = () => {\n  const [followersLimit, setFollowersLimit] = useState(3);\n  const [followingsLimit, setFollowingsLimit] = useState(3);\n\n  const dispatch = useDispatch();\n  const { me } = useSelector((state) => state.user);\n  const { data: followersData, followerError } = useSWR(\n    `http://localhost:3075/user/followers?limit=${followersLimit}`,\n    fetcher\n  );\n  const { data: followingsData, followingError } = useSWR(\n    `http://localhost:3075/user/followings?limit=${followingsLimit}`,\n    fetcher\n  );\n\n  /* useEffect(() => {\n    dispatch({\n      type: LOAD_FOLLOWERS_REQUEST,\n    });\n    dispatch({\n      type: LOAD_FOLLOWINGS_REQUEST,\n    });\n  }, []);\n  */\n\n  useEffect(() => {\n    if (!(me && me.id)) {\n      Router.push(\"/\");\n    }\n  }, [me && me.id]);\n\n  const loadMoreFollowings = useCallback(() => {\n    setFollowingsLimit((prev) => prev + 3);\n  }, []);\n\n  const loadMoreFollowers = useCallback(() => {\n    setFollowersLimit((prev) => prev + 3);\n  }, []);\n\n  if (!me) {\n    return \"내 정보 로딩 중\";\n  }\n\n  if (followerError || followingError) {\n    console.error(followerError || followingError);\n    return <div>팔로잉/팔로워 로딩 중 에러가 발생합니다.</div>;\n  }\n\n  return (\n    <>\n      <Head>\n        <title>내 프로필</title>\n      </Head>\n      <AppLayout>\n        <NicknameEditForm />\n        <FollowList\n          header=\"팔로잉\"\n          data={followingsData}\n          onClickMore={loadMoreFollowings}\n          loading={!followingsData && !followingError}\n        />\n        <FollowList\n          header=\"팔로워\"\n          data={followersData}\n          onClickMore={loadMoreFollowers}\n          loading={!followersData && !followerError}\n        />\n      </AppLayout>\n    </>\n  );\n};\n\nexport const getServerSideProps = wrapper.getServerSideProps(\n  async (context) => {\n    const cookie = context.req ? context.req.headers.cookie : \"\";\n    axios.defaults.headers.Cookie = \"\";\n    if (context.req && cookie) {\n      axios.defaults.headers.Cookie = cookie;\n    } //Cookie 넣어줘야 로그인 새로고침 가능\n    context.store.dispatch({\n      type: LOAD_MY_INFO_REQUEST,\n    });\n    context.store.dispatch({\n      type: LOAD_POSTS_REQUEST,\n    });\n    context.store.dispatch(END);\n    await context.store.sagaTask.toPromise();\n  }\n);\n\nexport default Profile;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}